# TeachProxy 环境变量配置模板
# 复制此文件为 .env 并填写实际值

# ============================================================
# 数据库配置
# ============================================================
# 方式1: 完整 URL（推荐）
DATABASE_URL=postgresql+asyncpg://teachproxy:teachproxy123@localhost:5432/teachproxy

# 方式2: 分别配置（备用）
# DB_HOST=localhost
# DB_PORT=5432
# DB_USER=teachproxy
# DB_PASSWORD=teachproxy123
# DB_NAME=teachproxy

# 连接池配置
DB_POOL_SIZE=100
DB_MAX_OVERFLOW=50
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=300
DB_POOL_PRE_PING=true

# ============================================================
# AI 提供商配置
# ============================================================
# DeepSeek（必需）
DEEPSEEK_API_KEY=sk-your-deepseek-api-key
DEEPSEEK_BASE_URL=https://api.deepseek.com/v1

# OpenAI（可选，作为备用提供商）
OPENAI_API_KEY=
OPENAI_BASE_URL=https://api.openai.com/v1

# 默认提供商
DEFAULT_PROVIDER=deepseek

# Mock 提供商（仅测试用）
# TEACHPROXY_MOCK_PROVIDER=false

# ============================================================
# 缓存配置
# ============================================================
# 内存缓存
CACHE_ENABLED=true
CACHE_DEFAULT_TTL=300

# Redis 缓存（生产环境推荐）
REDIS_ENABLED=false
REDIS_URL=redis://localhost:6379/0

# ============================================================
# 限流配置
# ============================================================
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST_SIZE=10
RATE_LIMIT_WINDOW_SECONDS=60
RATE_LIMIT_FAIL_CLOSED=false

# ============================================================
# 请求路由配置
# ============================================================
REQUEST_ROUTER_ENABLED=true
REQUEST_ROUTER_STREAMING_LIMIT=50
REQUEST_ROUTER_NORMAL_LIMIT=200
REQUEST_ROUTER_TIMEOUT=5.0

# ============================================================
# 安全配置
# ============================================================
# 管理员令牌（必需，请设置强密码）
ADMIN_TOKEN=your-secure-admin-token-here

# CORS 配置（生产环境应限制源）
# CORS_ORIGINS=["https://admin.example.com"]

# ============================================================
# 日志配置
# ============================================================
LOG_LEVEL=INFO
# LOG_FORMAT=json  # 生产环境推荐

# ============================================================
# HTTP 客户端配置
# ============================================================
HTTPX_TIMEOUT=60.0
HTTPX_CONNECT_TIMEOUT=10.0
HTTPX_READ_TIMEOUT=60.0
HTTPX_MAX_CONNECTIONS=100
HTTPX_MAX_KEEPALIVE_CONNECTIONS=20

# ============================================================
# 学期配置
# ============================================================
# 学期开始日期（格式: YYYY-MM-DD）
# SEMESTER_START_DATE=2026-02-17
# SEMESTER_WEEKS=16

# ============================================
# Balance Architecture Settings
# ============================================

# Teacher Key Pool - DeepSeek Direct (Primary)
TEACHER_DEEPSEEK_API_KEY=sk-your-deepseek-key
TEACHER_DEEPSEEK_BASE_URL=https://api.deepseek.com/v1
DEEPSEEK_DIRECT_TIMEOUT=15.0

# Teacher Key Pool - OpenRouter (Fallback)
TEACHER_OPENROUTER_API_KEY=sk-your-openrouter-key
TEACHER_OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
OPENROUTER_TIMEOUT=30.0

# LLM Cache Settings
LLM_CACHE_ENABLED=true
LLM_CACHE_TTL_CONCEPT=3600
LLM_CACHE_TTL_GENERAL=600
LLM_CACHE_PREFIX=teachproxy:v1

# API Key Encryption (generate with: python -c "import secrets; print(secrets.token_urlsafe(32))")
API_KEY_ENCRYPTION_KEY=your-32-byte-encryption-key-here
